{"version":3,"file":"publish.js","sourceRoot":"","sources":["../../../../src/cli/commands/theme/publish.ts"],"names":[],"mappings":";AAAA,OAAO,EAAC,gBAAgB,EAAC,MAAM,gCAAgC,CAAA;AAC/D,OAAO,YAAY,MAAM,kCAAkC,CAAA;AAC3D,OAAO,EAAC,UAAU,EAAC,MAAM,gBAAgB,CAAA;AACzC,OAAO,EAAC,OAAO,EAAE,sBAAsB,EAAC,MAAM,2BAA2B,CAAA;AACzE,OAAO,EAAC,KAAK,EAAC,MAAM,aAAa,CAAA;AACjC,OAAO,EAAC,WAAW,EAAC,MAAM,2BAA2B,CAAA;AACrD,OAAO,EAAC,yBAAyB,EAAC,MAAM,+BAA+B,CAAA;AAEvE,MAAqB,OAAQ,SAAQ,YAAY;IAiC/C,KAAK,CAAC,GAAG;QACP,MAAM,EAAC,KAAK,EAAE,IAAI,EAAC,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,EAAO,CAAC,CAAA;QAC/C,MAAM,KAAK,GAAG,MAAM,gBAAgB,CAAC,KAAK,CAAC,CAAA;QAC3C,MAAM,YAAY,GAAG,MAAM,yBAAyB,CAAC,KAAK,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAA;QAC3E,MAAM,OAAO,GAAG,KAAK,CAAC,KAAK,IAAI,IAAI,CAAC,CAAC,CAAC,CAAA;QAEtC,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,IAAI,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;YAClD,sBAAsB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAA;SAChC;QAED,MAAM,OAAO,CAAC,YAAY,EAAE,OAAO,EAAE,KAAK,CAAC,CAAA;IAC7C,CAAC;;;AA3CM,eAAO,GAAG,uCAAuC,AAA1C,CAA0C;AAEjD,+BAAuB,GAAG;;;;;;6NAM0L,AAN7L,CAM6L;AAEpN,mBAAW,GAAG,EAAI,CAAC,0BAA0B,EAAE,AAApC,CAAoC;AAEtD,gDAAgD;AACzC,cAAM,GAAG,KAAK,AAAR,CAAQ;AAEd,aAAK,GAAG;IACb,GAAG,WAAW;IACd,QAAQ,EAAE,UAAU,CAAC,QAAQ;IAC7B,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC;QACnB,IAAI,EAAE,GAAG;QACT,WAAW,EAAE,oBAAoB;QACjC,GAAG,EAAE,oBAAoB;KAC1B,CAAC;IACF,KAAK,EAAE,KAAK,CAAC,MAAM,CAAC;QAClB,IAAI,EAAE,GAAG;QACT,WAAW,EAAE,uCAAuC;QACpD,GAAG,EAAE,uBAAuB;KAC7B,CAAC;IACF,KAAK,EAAE,UAAU,CAAC,KAAK;IACvB,WAAW,EAAE,UAAU,CAAC,WAAW;CACpC,AAfW,CAeX;eA/BkB,OAAO","sourcesContent":["import {ensureThemeStore} from '../../utilities/theme-store.js'\nimport ThemeCommand from '../../utilities/theme-command.js'\nimport {themeFlags} from '../../flags.js'\nimport {publish, renderArgumentsWarning} from '../../services/publish.js'\nimport {Flags} from '@oclif/core'\nimport {globalFlags} from '@shopify/cli-kit/node/cli'\nimport {ensureAuthenticatedThemes} from '@shopify/cli-kit/node/session'\n\nexport default class Publish extends ThemeCommand {\n  static summary = 'Set a remote theme as the live theme.'\n\n  static descriptionWithMarkdown = `Publishes an unpublished theme from your theme library.\n\nIf no theme ID is specified, then you're prompted to select the theme that you want to publish from the list of themes in your store.\n\nYou can run this command only in a directory that matches the [default Shopify theme folder structure](https://shopify.dev/docs/themes/tools/cli#directory-structure).\n\nIf you want to publish your local theme, then you need to run \\`shopify theme push\\` first. You're asked to confirm that you want to publish the specified theme. You can skip this confirmation using the \\`--force\\` flag.`\n\n  static description = this.descriptionWithoutMarkdown()\n\n  // Accept any number of args without naming them\n  static strict = false\n\n  static flags = {\n    ...globalFlags,\n    password: themeFlags.password,\n    force: Flags.boolean({\n      char: 'f',\n      description: 'Skip confirmation.',\n      env: 'SHOPIFY_FLAG_FORCE',\n    }),\n    theme: Flags.string({\n      char: 't',\n      description: 'Theme ID or name of the remote theme.',\n      env: 'SHOPIFY_FLAG_THEME_ID',\n    }),\n    store: themeFlags.store,\n    environment: themeFlags.environment,\n  }\n\n  async run(): Promise<void> {\n    const {flags, argv} = await this.parse(Publish)\n    const store = await ensureThemeStore(flags)\n    const adminSession = await ensureAuthenticatedThemes(store, flags.password)\n    const themeId = flags.theme || argv[0]\n\n    if (argv.length > 0 && typeof argv[0] === 'string') {\n      renderArgumentsWarning(argv[0])\n    }\n\n    await publish(adminSession, themeId, flags)\n  }\n}\n"]}